Sub stocks():        For Each ws In Worksheets       With ws               'set variables        Dim ticker As String        Dim yearlychange As Double        Dim percentchange As Double        Dim totalstockvolume As LongLong        Dim openingprice As Double        Dim closingprice As Double        Dim lastrow As Long        Dim i_summarytablerow As Integer        Dim i As Long            'establish column headers        ws.Range("I1").Value = "Ticker"        ws.Range("J1").Value = "Yearly Change"        ws.Range("K1").Value = "Percent Change"        ws.Range("L1").Value = "Total Stock Volume"        'set variables        lastrow = Cells(Rows.Count, 1).End(xlUp).Row        openingprice = Range("C2").Value        totalstockvolume = 0        i_summarytablerow = 2               'start for loop         For i = 2 To lastrow            'set totalstockvolume            totalstockvolume = totalstockvolume + .Cells(i, 7).Value            'set conditional            If .Cells(i + 1, 1).Value <> .Cells(i, 1).Value Then                closingprice = .Cells(i, 6).Value                 If openingprice > 0 Then                    percentchange = (openingprice - closingprice) / openingprice                Else                    percentchange = openingprice - closingprice                End If            'shows ticker symbol in summary table                .Cells(i_summarytablerow, 9).Value = .Cells(i, 1).Value            'shows yearly change in summary table                yearlychange = openingprice - closingprice                 .Cells(i_summarytablerow, 10).Value = yearlychange    'shows percentchange in summary table                .Cells(i_summarytablerow, 11).Value = percentchange                .Cells(i_summarytablerow, 11).NumberFormat = "0.00%"    'shows total stock volume in summary table                .Cells(i_summarytablerow, 12).Value = totalstockvolume    'update openingprice                openingprice = .Cells(i + 1, 3).Value                i_summarytablerow = i_summarytablerow + 1        'totalstockvolume = 0            End If            'conditional formating to show positive increases in green and negative ones in red            If .Cells(i, 10).Value <= 0 Then                .Cells(i, 10).Interior.ColorIndex = 3            Else                .Cells(i, 10).Interior.ColorIndex = 4            End If        Next i    .UsedRange.Columns.AutoFit    End With    Next ws    End Sub